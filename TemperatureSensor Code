CS EQU P0.6
RD EQU P3.7 
WR EQU P3.6
INTR EQU P3.2
RS EQU P1.4
RW EQU P1.5
EN EQU P1.6
MYDATA EQU P2
ORG 00H
MOV P2,#0FFH
SETB INTR
BACK:CLR WR
ACALL DELAY
CLR CS
SETB WR
HERE:JB INTR,HERE
CLR RD
MOV A,MYDATA
ACALL CONVERSION
ACALL DISPLAY
SETB RD
SJMP BACK

CONVERSION:
MOV B,#10
DIV AB
MOV R7,B
MOV B,#10
DIV AB
MOV R6,B
MOV R5,A
RET

DELAY:
MOV R3,#50H
TIMEDELAY:DJNZ R3,TIMEDELAY
RET

DISPLAY:
MOV A,#38H
ACALL COMMAND
MOV A,#0EH
ACALL COMMAND
MOV A,#01H
ACALL COMMAND
MOV A,#06H
ACALL COMMAND
MOV A,R7
ACALL DATA
MOV A,R6
ACALL DATA
MOV A,R5
ACALL DATA
RET

COMMAND:
ACALL READY
MOV P1,A
CLR RS
CLR RW
SETB EN
CLR EN
RET

DATA:
ACALL READY
MOV P1,A
SETB RS
CLR RW
SETB EN
ACALL DELAY
CLR EN
RET

READY:
SETB P1.7
CLR RS
SETB RW
BACK1:CLR EN
ACALL DELAY
SETB EN
JB P1.7,BACK1
RET 
END
